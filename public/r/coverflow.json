{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "coverflow",
  "title": "Cover Flow",
  "description": "Apple-style Cover Flow component with 3D motion",
  "dependencies": [
    "motion"
  ],
  "files": [
    {
      "path": "registry/coverflow/coverflow.tsx",
      "content": "\"use client\";\n\nimport type { KeyboardEvent as ReactKeyboardEvent } from \"react\";\nimport { useCallback, useEffect, useRef, useState } from \"react\";\nimport {\n  motion,\n  useMotionValue,\n  useTransform,\n  useSpring,\n  PanInfo,\n  MotionValue,\n} from \"motion/react\";\n\nexport interface CoverFlowItem {\n  id: string | number;\n  image: string;\n  title: string;\n  subtitle?: string;\n}\n\nexport interface CoverFlowProps {\n  items: CoverFlowItem[];\n  itemWidth?: number;\n  itemHeight?: number;\n  stackSpacing?: number;\n  centerGap?: number;\n  rotation?: number;\n  initialIndex?: number;\n  enableReflection?: boolean;\n  className?: string;\n  onItemClick?: (item: CoverFlowItem, index: number) => void;\n  onIndexChange?: (index: number) => void;\n}\n\nexport function CoverFlow({\n  items,\n  itemWidth = 400,\n  itemHeight = 400,\n  stackSpacing = 100,\n  centerGap = 250,\n  rotation = 50,\n  initialIndex = 0,\n  enableReflection = false,\n  className,\n  onItemClick,\n  onIndexChange,\n}: CoverFlowProps) {\n  const [activeIndex, setActiveIndex] = useState(initialIndex);\n  const containerRef = useRef<HTMLDivElement>(null);\n  const scrollX = useMotionValue(initialIndex);\n\n  const springX = useSpring(scrollX, {\n    stiffness: 150,\n    damping: 30,\n    mass: 1,\n  });\n\n  useEffect(() => {\n    setActiveIndex(initialIndex);\n  }, [initialIndex]);\n\n  useEffect(() => {\n    onIndexChange?.(activeIndex);\n  }, [activeIndex, onIndexChange]);\n\n  useEffect(() => {\n    scrollX.set(activeIndex);\n  }, [activeIndex, scrollX]);\n\n  const jumpToIndex = useCallback(\n    (index: number) => {\n      const clamped = Math.min(Math.max(index, 0), items.length - 1);\n      setActiveIndex(clamped);\n    },\n    [items.length]\n  );\n\n  const onKeyDown = useCallback(\n    (e: ReactKeyboardEvent<HTMLDivElement>) => {\n      if (e.key === \"ArrowLeft\") {\n        e.preventDefault();\n        jumpToIndex(activeIndex - 1);\n      }\n      if (e.key === \"ArrowRight\") {\n        e.preventDefault();\n        jumpToIndex(activeIndex + 1);\n      }\n    },\n    [activeIndex, jumpToIndex]\n  );\n\n  const onDrag = (event: any, info: PanInfo) => {\n    const deltaIndex = -info.delta.x / (centerGap * 0.8);\n    const current = springX.get();\n    scrollX.set(current + deltaIndex);\n  };\n\n  const onDragEnd = (event: any, info: PanInfo) => {\n    const current = springX.get();\n    const velocity = info.velocity.x;\n    const projected = current - velocity * 0.002;\n    const targetIndex = Math.round(projected);\n    const clampedIndex = Math.min(\n      Math.max(targetIndex, 0),\n      items.length - 1\n    );\n    setActiveIndex(clampedIndex);\n  };\n\n  return (\n    <div\n      ref={containerRef}\n      className={\n        \"relative w-full h-full flex flex-col justify-center items-center overflow-hidden bg-transparent focus:outline-none \" +\n        (className ?? \"\")\n      }\n      style={{ perspective: 1000 }}\n      role=\"region\"\n      aria-label=\"Cover Flow\"\n      tabIndex={0}\n      onKeyDown={onKeyDown}\n    >\n      <motion.div\n        className=\"absolute inset-0 z-50 cursor-grab active:cursor-grabbing touch-none\"\n        drag=\"x\"\n        dragConstraints={{ left: 0, right: 0 }}\n        dragElastic={0}\n        dragMomentum={false}\n        onDrag={onDrag}\n        onDragEnd={onDragEnd}\n        style={{ opacity: 0 }}\n      />\n\n      <div\n        className=\"relative w-full h-full flex items-center justify-center\"\n        style={{ transformStyle: \"preserve-3d\" }}\n      >\n        {items.map((item, index) => (\n          <CoverFlowItemCard\n            key={item.id}\n            item={item}\n            index={index}\n            scrollX={springX}\n            width={itemWidth}\n            height={itemHeight}\n            stackSpacing={stackSpacing}\n            centerGap={centerGap}\n            rotation={rotation}\n            isActive={index === activeIndex}\n            enableReflection={enableReflection}\n            onClick={() => {\n              if (index === activeIndex) {\n                onItemClick?.(item, index);\n              } else {\n                jumpToIndex(index);\n              }\n            }}\n          />\n        ))}\n      </div>\n\n      <div className=\"absolute bottom-8 left-0 right-0 flex flex-col items-center justify-center pointer-events-none z-40 transition-opacity duration-300\">\n        <motion.div\n          initial={{ opacity: 0, y: 10 }}\n          animate={{ opacity: 1, y: 0 }}\n          key={activeIndex}\n          transition={{ duration: 0.4, ease: \"easeOut\" }}\n          className=\"text-center\"\n        >\n          <h3 className=\"text-2xl font-semibold text-foreground tracking-tight drop-shadow-md\">\n            {items[activeIndex]?.title}\n          </h3>\n          {items[activeIndex]?.subtitle && (\n            <p className=\"text-foreground/60 text-sm mt-1 font-medium tracking-wide\">\n              {items[activeIndex]?.subtitle}\n            </p>\n          )}\n        </motion.div>\n      </div>\n    </div>\n  );\n}\n\ninterface CardProps {\n  item: CoverFlowItem;\n  index: number;\n  scrollX: MotionValue<number>;\n  width: number;\n  height: number;\n  stackSpacing: number;\n  centerGap: number;\n  rotation: number;\n  isActive: boolean;\n  enableReflection: boolean;\n  onClick: () => void;\n}\n\nfunction CoverFlowItemCard({\n  item,\n  index,\n  scrollX,\n  width,\n  height,\n  stackSpacing,\n  centerGap,\n  rotation,\n  isActive,\n  enableReflection,\n  onClick,\n}: CardProps) {\n  const position = useTransform(scrollX, (value) => index - value);\n\n  const zIndex = useTransform(position, (pos) => 1000 - Math.abs(pos) * 10);\n\n  const t = useTransform(position, (pos) => {\n    const absPos = Math.abs(pos);\n    const isCenter = absPos < 0.5;\n\n    let rY = 0;\n    if (pos < -0.5) rY = rotation;\n    if (pos > 0.5) rY = -rotation;\n    if (isCenter) rY = -pos * (rotation * 2);\n\n    let x = 0;\n    if (pos < 0) {\n      const stackIndex = Math.max(0, absPos - 1);\n      x = absPos < 1 ? pos * centerGap : -centerGap - stackIndex * stackSpacing;\n    } else {\n      const stackIndex = Math.max(0, absPos - 1);\n      x = absPos < 1 ? pos * centerGap : centerGap + stackIndex * stackSpacing;\n    }\n\n    let z = absPos > 0.5 ? -200 : Math.abs(pos) * -400;\n\n    return { rotateY: rY, x, z };\n  });\n\n  const rotateY = useTransform(t, (v) => v.rotateY);\n  const x = useTransform(t, (v) => v.x);\n  const z = useTransform(t, (v) => v.z);\n\n  const brightness = useTransform(position, (pos) =>\n    Math.abs(pos) < 0.5 ? 1 : 0.5\n  );\n\n  return (\n    <motion.div\n      className=\"absolute top-1/2 left-1/2 preserve-3d will-change-transform\"\n      style={{\n        width,\n        height,\n        marginTop: -height / 2,\n        marginLeft: -width / 2,\n        x,\n        z,\n        rotateY,\n        zIndex,\n        filter: useTransform(brightness, (b) => `brightness(${b})`),\n      }}\n      onClick={onClick}\n    >\n      <div className=\"relative w-full h-full rounded-xl shadow-2xl bg-black\">\n        <div className=\"absolute inset-0 rounded-xl border border-white/10 z-20 pointer-events-none\" />\n\n        <div className=\"relative w-full h-full overflow-hidden rounded-xl\">\n          <img\n            src={item.image}\n            alt={item.title}\n            draggable={false}\n            className=\"absolute inset-0 h-full w-full object-cover select-none pointer-events-none\"\n          />\n          <div className=\"absolute inset-0 bg-linear-to-tr from-white/10 to-transparent opacity-0 dark:opacity-20 pointer-events-none z-10\" />\n        </div>\n      </div>\n\n      {enableReflection && (\n        <div\n          className=\"absolute left-0 right-0 overflow-hidden pointer-events-none\"\n          style={{\n            top: \"100%\",\n            width,\n            height: height * 0.35,\n            marginTop: \"2px\",\n          }}\n        >\n          <div\n            className=\"relative w-full h-full opacity-40\"\n            style={{ transform: \"scaleY(-1)\" }}\n          >\n            <img\n              src={item.image}\n              alt=\"\"\n              className=\"absolute inset-0 h-full w-full object-cover blur-[1px]\"\n            />\n            <div className=\"absolute inset-0 bg-linear-to-b from-background/90 to-transparent\" />\n          </div>\n        </div>\n      )}\n    </motion.div>\n  );\n}\n",
      "type": "registry:component"
    }
  ],
  "type": "registry:component"
}